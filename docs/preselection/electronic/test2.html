<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-preselection/electronic/test2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">2nd Test | The Winners</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/img/logo.png"><meta data-rh="true" property="og:url" content="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2nd Test | The Winners"><meta data-rh="true" name="description" content="Objectives"><meta data-rh="true" property="og:description" content="Objectives"><link data-rh="true" rel="icon" href="/2025-Team-The_Winners-Docs/img/fav.ico"><link data-rh="true" rel="canonical" href="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2"><link data-rh="true" rel="alternate" href="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2" hreflang="en"><link data-rh="true" rel="alternate" href="https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"2nd Test","item":"https://TekBot-Robotics-Challenge.github.io/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2"}]}</script><link rel="stylesheet" href="/2025-Team-The_Winners-Docs/assets/css/styles.3e016ada.css">
<script src="/2025-Team-The_Winners-Docs/assets/js/runtime~main.f6e8fd25.js" defer="defer"></script>
<script src="/2025-Team-The_Winners-Docs/assets/js/main.444bb277.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/2025-Team-The_Winners-Docs/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/2025-Team-The_Winners-Docs/"><div class="navbar__logo"><img src="/2025-Team-The_Winners-Docs/img/logo.png" alt="The Winners" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/2025-Team-The_Winners-Docs/img/logo.png" alt="The Winners" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a><a class="navbar__item navbar__link" href="/2025-Team-The_Winners-Docs/docs/about/introduction">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test1">Pre-selection Tests</a><a class="navbar__item navbar__link" href="/2025-Team-The_Winners-Docs/docs/robot/electronic">Robot Design</a><a class="navbar__item navbar__link" href="/2025-Team-The_Winners-Docs/docs/media/photos">Media</a><a class="navbar__item navbar__link" href="/2025-Team-The_Winners-Docs/docs/link">Links</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test1">Pre-selection Tests</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test1">Electronic</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test1">1rst Test</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test2">2nd Test</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test3">3rd Test</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/computer/test1">Computer Science</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/mechanic/test1">Mechanic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/2025-Team-The_Winners-Docs/docs/preselection/final/electronic">Assembly</a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/2025-Team-The_Winners-Docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Pre-selection Tests</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Electronic</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">2nd Test</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>2nd Test</h1></header>
<div align="justify"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a href="#objectives" class="hash-link" aria-label="Direct link to Objectives" title="Direct link to Objectives">​</a></h2><hr><p>In industries like automotive, aviation, and rail, black boxes are essential for monitoring vehicle activity. These systems record various parameters; in aircraft, for instance, they log pilot communications and flight data such as speed, altitude, and spatial orientation using advanced sensors. This information is crucial for crash investigations.</p><p>For the Tekbot Robotics Challenge, your task is to design a black box capable of recording speed and spatial position data using a gyroscope and accelerometer. This data must be transmitted in real time via I2C to a control station where it will be displayed on an LCD screen. The project has two components: a data-collecting/transmitting black box and a control station for receiving and displaying the data. You’ll present the project through a video showing the box moving in space with its motion data visualized on the control station.</p><p><strong>Technical Requirements:</strong></p><ul>
<li>Reuse the same sensor as the previous project, meaning success depends on your earlier work.</li>
<li>Use Atmega328P microcontrollers directly, not Arduino boards.</li>
<li>Create electronic schematics using KICAD and design/produce your own PCBs.</li>
<li>Build a 7 cm cube (the black box) with an open top if the material is opaque, to view the circuit inside.</li>
<li>Design your own power supply (external to the cube).</li>
<li>Create an I2C bus where the microcontroller inside the cube is the only master, and the sensor (inside the cube) and control station microcontroller are slaves. The LCD should operate in 4-bit mode.</li>
<li>As before, move the cube in all directions and display real-time data on the LCD.</li>
<li>Document your work on the assigned GitHub repository.</li>
</ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>This documentation describes the design and fabrication of two custom PCBs:</p><ul>
<li>One embedded inside a 7×7 cm cube (the black box) responsible for sensing and sending data over I2C.</li>
<li>One external circuit acting as a control station that displays the data on an LCD in 4-bit mode and provides user feedback through LEDs.</li>
</ul><p>The boards were designed using <em>KiCad</em> and produced via <em>UV exposure and chemical etching</em>. Power supply and programming were handled via custom connectors and FTDI interfaces.</p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="files-available-for-download">Files available for download<a href="#files-available-for-download" class="hash-link" aria-label="Direct link to Files available for download" title="Direct link to Files available for download">​</a></h2><p>Download the KiCad and Arduino files by following these links :</p><p><strong>KiCad</strong></p><ul>
<li>
<p>Black box : <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-The_Winners-Docs/blob/main/Tekbot_The_Winners/electonic/test2/kicad/black_box/Test_2.kicad_pro" target="_blank" rel="noopener noreferrer">Black box KiCad file</a></p>
</li>
<li>
<p>Control station : Black box : <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-The_Winners-Docs/blob/main/Tekbot_The_Winners/electonic/test2/kicad/station_control/Test_22.kicad_pro" target="_blank" rel="noopener noreferrer">Control station KiCad file</a></p>
</li>
</ul><p><strong>Arduino</strong></p><ul>
<li>
<p>Black box : <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-The_Winners-Docs/blob/main/Tekbot_The_Winners/electonic/test2/code/Test2_BLACK.BOX_TRC.ino" target="_blank" rel="noopener noreferrer">Black box Arduino file</a></p>
</li>
<li>
<p>Control station : <a href="https://github.com/TekBot-Robotics-Challenge/2025-Team-The_Winners-Docs/blob/main/Tekbot_The_Winners/electonic/test2/code/TEST2_CONTROL_STATION_TRC.ino" target="_blank" rel="noopener noreferrer">Control station Arduino file</a></p>
</li>
</ul><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="materials">Materials<a href="#materials" class="hash-link" aria-label="Direct link to Materials" title="Direct link to Materials">​</a></h2><p>List of components used for both the black box and signaling box.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="black-box-circuit">Black Box Circuit<a href="#black-box-circuit" class="hash-link" aria-label="Direct link to Black Box Circuit" title="Direct link to Black Box Circuit">​</a></h3><p>Below is the list of the different components used for the design of the circuits in kiCad.</p><table><thead><tr><th>Component</th><th>Quantity</th><th>Description</th></tr></thead><tbody><tr><td>ATmega328P</td><td>1</td><td>Microcontroller</td></tr><tr><td>16MHz Quartz</td><td>1</td><td>Clock source for the microcontroller</td></tr><tr><td>22pF Capacitors</td><td>2</td><td>Polarization capacitors for the quartz</td></tr><tr><td>MPU 6050</td><td>1</td><td>Gyroscope and accelerometer sensor</td></tr><tr><td>Push Button</td><td>1</td><td>Reset button for the microcontroller</td></tr><tr><td>10k Resistor</td><td>1</td><td>Pull-up resistor for the reset button</td></tr><tr><td>LED</td><td>1</td><td>Indicator LED on pin 13</td></tr><tr><td>Connectors</td><td>1</td><td>For FTDI programmer and signaling box connection (I2C connection)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="signaling-box">Signaling box<a href="#signaling-box" class="hash-link" aria-label="Direct link to Signaling box" title="Direct link to Signaling box">​</a></h3><table><thead><tr><th>Component</th><th>Quantity</th><th>Description</th></tr></thead><tbody><tr><td>ATmega328P</td><td>1</td><td>Microcontroller</td></tr><tr><td>16MHz Quartz</td><td>1</td><td>Clock source for the microcontroller</td></tr><tr><td>22pF Capacitors</td><td>2</td><td>Polarization capacitors for the quartz</td></tr><tr><td>MPU 6050</td><td>1</td><td>Gyroscope and accelerometer sensor</td></tr><tr><td>Push Button</td><td>1</td><td>Reset button for the microcontrolleur</td></tr><tr><td>10k Resistor</td><td>1</td><td>Pull-up resistor for the reset button</td></tr><tr><td>LED</td><td>1</td><td>Indicator LED on pin 13</td></tr><tr><td>Connectors</td><td>3</td><td>For FTDI programmer, black box connection (I2C connection), and LCD (in 4 bits mode)</td></tr><tr><td>N-channel MOSFET</td><td>1</td><td>Protection against polarity reversal</td></tr><tr><td>LEDs</td><td>6</td><td>Indicator LEDs for movement directions of black box</td></tr></tbody></table><p><em>Tools and software:</em></p><ul>
<li>KiCad for schematic and PCB design</li>
<li>UV exposure box</li>
<li>Ferric chloride (FeCl₃) for etching</li>
<li>Drill press for holes</li>
<li>Soldering station</li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="process">Process<a href="#process" class="hash-link" aria-label="Direct link to Process" title="Direct link to Process">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="power-supply-design">Power Supply Design<a href="#power-supply-design" class="hash-link" aria-label="Direct link to Power Supply Design" title="Direct link to Power Supply Design">​</a></h3><p>In this test, we were asked to design our own power supply. So, we used the power supply built during the first test.</p><p>Here are the Pictures showing it :</p><table><thead><tr><th><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/ali1-ea3b0ac693cca1963f0ff81b9f420c23.jpg" width="900" height="1200" class="img_ev3q"></th><th><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/ali2-a44121cb4fa8ac1277aba2e335c03221.jpg" width="1200" height="900" class="img_ev3q"></th><th><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/ali3-00df970d77550b51c606be65feba1cdf.jpg" width="1200" height="900" class="img_ev3q"></th></tr></thead><tbody><tr><td><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/ali4-6a12297363b32fae4fcbff254b369b12.jpg" width="900" height="1200" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/ali5-5a0b346f7b7fca24ef38ddfc2291cfc5.jpg" width="900" height="1200" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/ali6-d1d297d8541f786d5d397ebba2e1ab0a.jpg" width="900" height="1200" class="img_ev3q"></td></tr></tbody></table><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-design">Hardware design<a href="#hardware-design" class="hash-link" aria-label="Direct link to Hardware design" title="Direct link to Hardware design">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="circuit-design-process">Circuit Design Process<a href="#circuit-design-process" class="hash-link" aria-label="Direct link to Circuit Design Process" title="Direct link to Circuit Design Process">​</a></h3><ol>
<li>
<p><em>Schematic Design (KiCad):</em></p>
<ul>
<li>
<p>Each circuit started with the basic ATmega328P configuration:</p>
<ul>
<li>Clock circuit: 16 MHz crystal + 2×22pF capacitors.</li>
<li>Reset circuit: Push button with 10kΩ pull-up.</li>
<li>Status LED on digital pin 13.</li>
<li>FTDI programming header (TX, RX, GND, VCC, DTR).</li>
</ul>
</li>
<li>
<p>For the <em>Black Box</em>:</p>
<ul>
<li>I2C connection to MPU6050.</li>
<li>Header for I2C output to control station.</li>
</ul>
</li>
<li>
<p>For the <em>Control Station</em>:</p>
<ul>
<li>I2C input from Black Box.</li>
<li>LCD interface in 4-bit mode.</li>
<li>6 LEDs for visual feedback on motion along 6 directions.</li>
<li>Polarity protection using a N-channel MOSFET.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><em>PCB Layout:</em></p>
<ul>
<li>All components were placed to ensure compact design, short traces, and accessible connectors.</li>
<li>Decoupling capacitors placed near power pins.</li>
<li>Ground plane added to reduce noise.</li>
</ul>
</li>
<li>
<p><em>Exporting and Printing:</em></p>
<ul>
<li>Layouts were exported as mirrored PDF files and printed on transparent film for UV exposure.</li>
</ul>
</li>
</ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcb-fabrication-process">PCB Fabrication Process<a href="#pcb-fabrication-process" class="hash-link" aria-label="Direct link to PCB Fabrication Process" title="Direct link to PCB Fabrication Process">​</a></h4><ol>
<li>
<p><em>UV Exposure:</em></p>
<ul>
<li>The printed film was placed over a photosensitive copper-clad board.</li>
<li>Exposed to UV light for ~8 minutes.</li>
</ul>
</li>
<li>
<p><em>Developing:</em></p>
<ul>
<li>Board developed in sodium hydroxide solution to reveal copper traces.</li>
</ul>
</li>
<li>
<p><em>Etching:</em></p>
<ul>
<li>Ferric chloride was used to remove unprotected copper.</li>
</ul>
</li>
<li>
<p><em>Drilling and Soldering:</em></p>
<ul>
<li>Holes drilled for through-hole components.</li>
<li>Components soldered in place with attention to orientation and clearance.</li>
</ul>
</li>
</ol><br><p><strong>Boite noire</strong></p><ul>
<li>Schematic capture:
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit1_schematic-1c62f9313eae92e17e7c741308af012b.png" width="1349" height="805" class="img_ev3q"></li>
</ul><br><ul>
<li>Printed circuit board overview :
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit1_pcb1-d562530314b8f2bc77f43b49438ec4f9.png" width="782" height="783" class="img_ev3q"></li>
</ul><br><p><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit1_pcb2-c1c968e8f5c6d1c7f5f23f5cedea1027.png" width="861" height="816" class="img_ev3q"></p><br><ul>
<li>3-D render of printed circuit board :
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit1_3D-1c9596837e76aa485a1442b4b45448e7.png" width="935" height="902" class="img_ev3q"></li>
</ul><br><p><strong>Boite de signalisation</strong></p><ul>
<li>Schematic capture: :
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit2_schematic-8623ffaae2005603cddf8ce9c5831e83.png" width="1242" height="823" class="img_ev3q"></li>
</ul><br><ul>
<li>Printed circuit board overview :
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit2_pcb2-ccc407a3aa6eabfc69473b82ee86ac4a.png" width="935" height="777" class="img_ev3q"></li>
</ul><br><p><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit2_pcb1-3644342983fa00490c815a7384e43552.png" width="1026" height="815" class="img_ev3q"></p><br><ul>
<li>3-D render of printed circuit board :
<img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/Test_2_circuit2_3D-69a63cff8247e62735cb68c8d006b69c.png" width="1006" height="801" class="img_ev3q"></li>
</ul><br><ul>
<li>Time-lapse of PCB etching</li>
<li>Assembly of components</li>
<li>Test of LED indicator and MPU movement detection</li>
<li>Data shown in real time on LCD display</li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="difficulties-and-solving-approach">Difficulties and Solving Approach<a href="#difficulties-and-solving-approach" class="hash-link" aria-label="Direct link to Difficulties and Solving Approach" title="Direct link to Difficulties and Solving Approach">​</a></h3><table><thead><tr><th>Problem</th><th>Solution</th></tr></thead><tbody><tr><td>Noise in sensor readings due to poor grounding</td><td>Added full ground plane and decoupling capacitors</td></tr><tr><td>Difficulty programming ATmega328P directly</td><td>Used FTDI interface with DTR for smooth uploading</td></tr><tr><td>LCD flickering</td><td>Implemented delay and correct 4-bit wiring</td></tr><tr><td>Power polarity inversion risk</td><td>Added MOSFET-based protection circuit</td></tr><tr><td>Manual drilling imprecision</td><td>Used small drill bits with guided PCB holders</td></tr></tbody></table><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="software-design">Software design<a href="#software-design" class="hash-link" aria-label="Direct link to Software design" title="Direct link to Software design">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="black-box">Black box<a href="#black-box" class="hash-link" aria-label="Direct link to Black box" title="Direct link to Black box">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-includes-et-définitions">1. Includes et Définitions<a href="#1-includes-et-définitions" class="hash-link" aria-label="Direct link to 1. Includes et Définitions" title="Direct link to 1. Includes et Définitions">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bibliothèques-incluses">Bibliothèques incluses<a href="#bibliothèques-incluses" class="hash-link" aria-label="Direct link to Bibliothèques incluses" title="Direct link to Bibliothèques incluses">​</a></h4><ul>
<li>
<p><code>#include &quot;I2Cdev.h&quot;</code> et <code>#include &quot;MPU6050_6Axis_MotionApps20.h&quot;</code> : Ces bibliothèques sont spécifiques au capteur MPU6050, particulièrement pour utiliser son processeur de mouvement numérique (DMP).</p>
<ul>
<li>Source : <a href="https://github.com/jrowberg/i2cdevlib" target="_blank" rel="noopener noreferrer">https://github.com/jrowberg/i2cdevlib</a></li>
</ul>
</li>
<li>
<p><code>#include &lt;Wire.h&gt;</code> : Bibliothèque Arduino standard pour la communication I2C (Inter-Integrated Circuit), essentielle pour communiquer avec le MPU6050 et la station de contrôle.</p>
</li>
<li>
<p><code>MPU6050 mpu;</code> : Crée une instance de l&#x27;objet MPU6050.</p>
</li>
<li>
<p><code>#define CONTROL_STATION_ADDRESS 0x20</code> : Définit l&#x27;adresse I2C de la station de contrôle, qui est l&#x27;esclave dans cette communication.</p>
</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-structure-de-données-et-variables">2. Structure de données et Variables<a href="#2-structure-de-données-et-variables" class="hash-link" aria-label="Direct link to 2. Structure de données et Variables" title="Direct link to 2. Structure de données et Variables">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="structure-mpudata">Structure MPUData<a href="#structure-mpudata" class="hash-link" aria-label="Direct link to Structure MPUData" title="Direct link to Structure MPUData">​</a></h4><p><code>struct MPUData</code> : Cette structure est conçue pour contenir toutes les données pertinentes du MPU6050 et les informations de mouvement calculées. Cette structure doit correspondre à celle définie dans le code de la station de contrôle pour un échange de données correct.</p><p><code>MPUData mpuData;</code> : Une instance de la structure MPUData pour stocker les données avant de les envoyer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="conteneurs-de-données-mpu6050">Conteneurs de données MPU6050<a href="#conteneurs-de-données-mpu6050" class="hash-link" aria-label="Direct link to Conteneurs de données MPU6050" title="Direct link to Conteneurs de données MPU6050">​</a></h4><ul>
<li><code>Quaternion q;</code> : Stocke les composants du quaternion.</li>
<li><code>VectorInt16 aa;</code> : Stocke les données brutes de l&#x27;accéléromètre.</li>
<li><code>VectorInt16 aaWorld;</code> : Stocke l&#x27;accélération corrigée de la gravité dans le référentiel mondial.</li>
<li><code>VectorInt16 aaReal;</code> : Stocke les mesures du capteur d&#x27;accélération sans gravité.</li>
<li><code>VectorInt16 gy;</code> : Stocke les mesures du capteur gyroscope.</li>
<li><code>VectorFloat gravity;</code> : Stocke le vecteur de gravité.</li>
<li><code>float ypr[3];</code> : Un tableau pour stocker les angles de lacet, tangage et roulis.</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables-de-détection-de-mouvement">Variables de détection de mouvement<a href="#variables-de-détection-de-mouvement" class="hash-link" aria-label="Direct link to Variables de détection de mouvement" title="Direct link to Variables de détection de mouvement">​</a></h4><ul>
<li><code>VectorInt16 prevAccel = { 0, 0, 0 };</code> : Stocke les valeurs d&#x27;accélération précédentes pour calculer les différences d&#x27;accélération pour la détection de mouvement.</li>
<li><code>unsigned long prevTime = 0;</code> : Stocke l&#x27;horodatage précédent pour les calculs deltaTime.</li>
<li><code>float movementThreshold = 1.0;</code> : Un seuil configurable (en m/s²) pour déterminer si un mouvement est suffisamment significatif pour être détecté.</li>
<li><code>byte lastMovementDetected = 0;</code> : Une variable globale pour stocker le dernier code de mouvement reconnu. C&#x27;est la valeur envoyée à la station de contrôle. Les codes de mouvement vont de 0 (Pas de mouvement/Inactif) à 6 (Arrière).</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-fonction-setup">3. Fonction setup()<a href="#3-fonction-setup" class="hash-link" aria-label="Direct link to 3. Fonction setup()" title="Direct link to 3. Fonction setup()">​</a></h4><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize Wire as Master for both MPU6050 and Control Station communication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Initializes the Wire library, setting the Arduino as an I2C Master.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setClock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">400000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Sets the I2C communication speed to 400kHz (fast mode).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LED_BUILTIN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Configures the built-in LED as an output, likely for status indication.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize Serial for debugging (via USB-TTL if standalone ATMEGA)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Initializing Black Box as I2C Master...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Initializing MPU6050...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize and test MPU6050 connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">testConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* Checks if the MPU6050 connection is successful. If not, it prints an error and halts execution.*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MPU6050 connection failed!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Stop execution if connection fails</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MPU6050 connected.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize the MPU6050 DMP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  devStatus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpInitialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Initializes the MPU6050&#x27;s Digital Motion Processor (DMP).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Set default calibration offsets (adjust if needed)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/*Sets default calibration offsets for the gyroscope and accelerometer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   These might need adjustment for specific sensor units.*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setXGyroOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setYGyroOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setZGyroOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setXAccelOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setYAccelOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setZAccelOffset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">devStatus </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">//Checks if DMP initialization was successful.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Auto-calibration (may take a few seconds)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Calibrating MPU6050... Do not move.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CalibrateAccel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CalibrateGyro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">PrintActiveOffsets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Print offsets if you want to note them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Calibration complete.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setDMPEnabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DMPReady </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    packetSize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetFIFOPacketSize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Gets the expected packet size from the DMP.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;DMP ready.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;DMP initialization failed with code: &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">devStatus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Stop execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Initialize previous time for deltaTime calculation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  prevTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">millis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Black Box Master ready. Searching for Control Station...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//************************************************************</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LED_BUILTIN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// turn the LED on (HIGH is the voltage level)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                      </span><span class="token comment" style="color:#999988;font-style:italic">// wait for a second</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LED_BUILTIN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LOW</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// turn the LED off by making the voltage LOW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                      </span><span class="token comment" style="color:#999988;font-style:italic">// wait for a second</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//************************************************************</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-fonction-loop">4. Fonction loop()<a href="#4-fonction-loop" class="hash-link" aria-label="Direct link to 4. Fonction loop()" title="Direct link to 4. Fonction loop()">​</a></h4><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// LOOP FUNCTION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">DMPReady</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Make sure DMP is ready before proceeding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetCurrentFIFOPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FIFOBuffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Check if a new packet is available in FIFO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Read current time and calculate deltaTime (for future use, not directly for detection here)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token plain"> currentTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">millis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> deltaTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentTime </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> prevTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000.0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prevTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> currentTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Retrieve DMP data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetQuaternion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FIFOBuffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetGravity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gravity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetAccel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">aa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FIFOBuffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetLinearAccel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">aaReal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">aa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gravity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpConvertToWorldFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">aaWorld</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">aa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Converts acceleration to the world frame, removing gravity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetGyro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FIFOBuffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dmpGetYawPitchRoll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ypr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gravity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Fill MPU data structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// World frame accelerations in m/s²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aaWorld</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ay </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aaWorld</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">az </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aaWorld</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Gyroscope data in degrees/second</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_gyro_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_gyro_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_gyro_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Quaternion components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">qz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Euler angles in degrees</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">yaw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ypr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">M_PI</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pitch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ypr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">M_PI</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roll </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ypr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">M_PI</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Temperature in Celsius</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">temperature </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getTemperature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">340.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">36.53</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Compute real accelerations in m/s²</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ax</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> ay </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ay</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> az </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">az</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Compute acceleration differences (acceleration derivative)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> dx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ax </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prevAccel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> dy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ay </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prevAccel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> dz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> az </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prevAccel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get_acce_resolution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> EARTH_GRAVITY_MS2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Absolute values of differences</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> absDx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> absDy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> absDz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// No movement by default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// MOVEMENT DETECTION LOGIC (6 DIRECTIONS)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">bool</span><span class="token plain"> movementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDx </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDy </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDx </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDz </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDx </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> movementThreshold</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dominantAccel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> absDx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      movementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dx </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Right&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Right</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Right\t\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Left&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Left</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Left\t\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot; m/s²&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDy </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDx </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDy </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDz </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDy </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> movementThreshold</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dominantAccel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> absDy</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      movementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dy </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Forward&quot; (Push)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Forward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Forward (Push)\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Backward&quot; (Pull)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Backward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Backward (Pull)\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot; m/s²&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDz </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDx </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDz </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> absDy </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> absDz </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> movementThreshold</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dominantAccel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> absDz</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      movementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dz </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Down&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Down</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Down\t\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Movement &quot;Up&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for Up</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Up\t\t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">absDz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot; m/s²&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// No significant movement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">movementCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Code for None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      mpuData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dominantAccel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      lastMovementDetected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;No significant movement.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Send data to control station whenever there&#x27;s a change in movement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// or periodically even if no movement (you can adjust this logic)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sendDataToControlStation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Calls a function to transmit the populated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Update previous acceleration for next cycle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prevAccel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aaWorld</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Blank line for Serial Monitor readability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Small delay to avoid overwhelming the I2C bus</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">delay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-fonction-senddatatocontrolstation">5. Fonction sendDataToControlStation()<a href="#5-fonction-senddatatocontrolstation" class="hash-link" aria-label="Direct link to 5. Fonction sendDataToControlStation()" title="Direct link to 5. Fonction sendDataToControlStation()">​</a></h4><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Function to send complete MPU data to control station</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sendDataToControlStation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Send the complete MPU data structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">beginTransmission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CONTROL_STATION_ADDRESS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Initiates an I2C transmission to the Control Station at its defined address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">byte</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">mpuData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MPUData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* Writes the entire mpuData structure as a byte array over</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  the I2C bus. sizeof(MPUData) ensures all bytes of the structure are sent */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  byte result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">endTransmission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Ends the transmission and returns a byte indicating</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//the success or failure of the transmission</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;I2C transmission error: &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="codes-de-mouvement">Codes de mouvement<a href="#codes-de-mouvement" class="hash-link" aria-label="Direct link to Codes de mouvement" title="Direct link to Codes de mouvement">​</a></h4><table><thead><tr><th>Code</th><th>Mouvement</th></tr></thead><tbody><tr><td>0</td><td>Aucun mouvement/Inactif</td></tr><tr><td>1</td><td>Haut</td></tr><tr><td>2</td><td>Bas</td></tr><tr><td>3</td><td>Gauche</td></tr><tr><td>4</td><td>Droite</td></tr><tr><td>5</td><td>Avant (Poussée)</td></tr><tr><td>6</td><td>Arrière (Traction)</td></tr></tbody></table><br><h4 class="anchor anchorWithStickyNavbar_LWe7" id="control-station">Control station<a href="#control-station" class="hash-link" aria-label="Direct link to Control station" title="Direct link to Control station">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="includes-and-configuration">Includes and Configuration<a href="#includes-and-configuration" class="hash-link" aria-label="Direct link to Includes and Configuration" title="Direct link to Includes and Configuration">​</a></h4><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;Wire.h&gt;</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property comment" style="color:#999988;font-style:italic">// Essential for I2C communication  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;LiquidCrystal.h&gt;</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property comment" style="color:#999988;font-style:italic">// Used to interface with and control the LCD display  </span><br></span></code></pre></div></div><ul>
<li>
<p>Both <em>Wire.h</em> and <em>LiquidCrystal.h</em> are integrated or native libraries, directly incorporated into Arduino IDE</p>
</li>
<li>
<p>LiquidCrystal lcd(6, 7, 2, 3, 4, 5); : Initializes an LCD object with the specified pin connections in 4-bit mode</p>
</li>
<li>
<p>#define CONTROL_STATION_ADDRESS 0x20 : Defines the I2C address for the Control Station as a slave device</p>
</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-structure-and-variables">Data Structure and Variables<a href="#data-structure-and-variables" class="hash-link" aria-label="Direct link to Data Structure and Variables" title="Direct link to Data Structure and Variables">​</a></h4><ul>
<li>
<p>struct MPUData : Defined to hold MPU6050 sensor data received from the master</p>
</li>
<li>
<p>MPUData receivedData : Stores the latest received data</p>
</li>
<li>
<p>volatile bool newDataReceived = false; : Flag for new I2C data, declared volatile due to ISR modification</p>
</li>
<li>
<p>volatile byte dataBuffer[sizeof(MPUData)]; : Buffer for incoming I2C data</p>
</li>
<li>
<p>volatile byte bufferIndex = 0; : Index for tracking position in dataBuffer</p>
</li>
<li>
<p>byte displayMode = 0; : Controls current LCD display mode:</p>
<ul>
<li>
<p>0: Movement info</p>
</li>
<li>
<p>1: Accelerations</p>
</li>
<li>
<p>2: Gyro</p>
</li>
<li>
<p>3: Angles</p>
</li>
<li>
<p>4: Quaternions</p>
</li>
<li>
<p>5: Temperature</p>
</li>
</ul>
</li>
</ul><p>const char* movementNames[] : Maps movementCode to readable names</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="led-configuration-and-control-variables">LED Configuration and Control Variables<a href="#led-configuration-and-control-variables" class="hash-link" aria-label="Direct link to LED Configuration and Control Variables" title="Direct link to LED Configuration and Control Variables">​</a></h4><p>In setup() Function</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ledX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">turnOffAllLeds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lcd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lcd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setCursor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> lcd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Control Station&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lcd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setCursor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> lcd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Waiting...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CONTROL_STATION_ADDRESS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Wire</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">onReceive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">receiveEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div><ul>
<li>Serial prints confirm initialization and I2C address</li>
</ul><p>loop() Function</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">displayMode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">displayMode </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="led-control-functions">LED Control Functions<a href="#led-control-functions" class="hash-link" aria-label="Direct link to LED Control Functions" title="Direct link to LED Control Functions">​</a></h4><ul>
<li>
<p>turnOffAllLeds() : Sets all LED pins to LOW (off)</p>
</li>
<li>
<p>updateLedStatus() : Activates LED based on receivedData.movementCode</p>
<ul>
<li>
<p>0 (IDLE): No LED, blinking handled by handleLedBlinking()</p>
</li>
<li>
<p>1–6: Corresponding LED is set HIGH</p>
</li>
<li>
<p>Unknown: Calls blinkAllLedsError()</p>
</li>
</ul>
</li>
<li>
<p>handleLedBlinking() : If IDLE, toggles LEDs every BLINK_INTERVAL (500ms)</p>
</li>
<li>
<p>blinkAllLedsError() : All LEDs blink rapidly at ERROR_BLINK_INTERVAL (150ms)</p>
</li>
<li>
<p>updateLedIntensityPattern() :</p>
<ul>
<li>
<p>Computes 3D acceleration magnitude</p>
</li>
<li>
<p>Determines number of LEDs to light based on magnitude thresholds</p>
</li>
</ul>
</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="display-and-debug-functions">Display and Debug Functions<a href="#display-and-debug-functions" class="hash-link" aria-label="Direct link to Display and Debug Functions" title="Direct link to Display and Debug Functions">​</a></h4><ul>
<li>
<p>printAllDataToSerial() :</p>
<ul>
<li>
<p>Prints all received MPU6050 data to Serial Monitor</p>
</li>
<li>
<p>Includes movement, dominant acceleration, accelerations, gyroscope, Euler angles, quaternions, temperature</p>
</li>
</ul>
</li>
<li>
<p>updateLCDDisplay() :</p>
<ul>
<li>
<p>Based on displayMode value, shows:</p>
<ul>
<li>
<p>0: Movement name &amp; dominant acceleration</p>
</li>
<li>
<p>1: X, Y, Z accelerations</p>
</li>
<li>
<p>2: X, Y, Z gyroscope values</p>
</li>
<li>
<p>3: Yaw, Pitch, Roll angles</p>
</li>
<li>
<p>4: Quaternions W, X, Y (Z not shown — likely oversight)</p>
</li>
<li>
<p>5: Temperature in Celsius</p>
</li>
</ul>
</li>
</ul>
</li>
</ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="i2c-communication-function">I2C Communication Function<a href="#i2c-communication-function" class="hash-link" aria-label="Direct link to I2C Communication Function" title="Direct link to I2C Communication Function">​</a></h4><ul>
<li>
<p>receiveEvent(int bytesReceived) : ISR triggered when I2C master sends data</p>
<ul>
<li>
<p>Resets bufferIndex</p>
</li>
<li>
<p>Reads bytes from I2C using Wire.available()</p>
</li>
<li>
<p>Stores bytes into dataBuffer[]</p>
</li>
<li>
<p>If buffer is complete (bufferIndex &gt;= sizeof(MPUData)):</p>
<ul>
<li>
<p>Copies content to receivedData using memcpy()</p>
</li>
<li>
<p>Sets newDataReceived = true</p>
</li>
</ul>
</li>
</ul>
</li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pictures">Pictures<a href="#pictures" class="hash-link" aria-label="Direct link to Pictures" title="Direct link to Pictures">​</a></h2><table><thead><tr><th><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/img1-fb16c5c384d2fa05a8c49a5db0314973.jpg" width="900" height="1200" class="img_ev3q"></th><th><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/img2-26de3ec46a01659aa68b71e89eef9ecb.jpg" width="900" height="1200" class="img_ev3q"></th><th><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/img3-15c495afd420daac525ad6cf4657bf99.jpg" width="900" height="1200" class="img_ev3q"></th></tr></thead><tbody><tr><td><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/img4-71e51dcd7b4d86866cc3d0aeefc038ed.jpg" width="900" height="1200" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/img5-ee79776f3a6500ea57e901d93717496a.jpg" width="1200" height="900" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/img6-5cc55bdbad7d7601a2c315f27a95aa03.jpg" width="900" height="1200" class="img_ev3q"></td></tr><tr><td><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/img7-b08da5edd1117df92397d0e50e48d9cb.jpg" width="900" height="1200" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/img8-1edbe0b65859d46d84f2af6aac510338.jpg" width="900" height="1200" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/img9-5b1bd555896c63666cb006dcab7860c2.jpg" width="1200" height="900" class="img_ev3q"></td></tr><tr><td><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/img10-55c898831b9d968398c7fbd323c633df.jpg" width="1200" height="900" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/img11-9829c9751dc44332579badc8bc6c5115.jpg" width="1200" height="900" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/img12-903259f6c9d53b73baf6b6de76e2e4f7.jpg" width="1200" height="900" class="img_ev3q"></td></tr><tr><td><img decoding="async" loading="lazy" alt="Img1" src="/2025-Team-The_Winners-Docs/assets/images/img13-43e72ca7469b33bc7488365258dda7a4.jpg" width="1200" height="900" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img2" src="/2025-Team-The_Winners-Docs/assets/images/img14-09c6318412e9bc3d3d47c63f3527abe2.jpg" width="1200" height="900" class="img_ev3q"></td><td><img decoding="async" loading="lazy" alt="Img3" src="/2025-Team-The_Winners-Docs/assets/images/img15-a16a22ec5703a3a56b2a15f4fd4c8275.jpg" width="1200" height="900" class="img_ev3q"></td></tr></tbody></table><br><p><a href="https://tekbot-robotics-challenge.github.io/2025-Team-The_Winners-Docs/docs/media/photos" target="_blank" rel="noopener noreferrer"><strong>See more...</strong></a></p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="videos">Videos<a href="#videos" class="hash-link" aria-label="Direct link to Videos" title="Direct link to Videos">​</a></h2><center><iframe src="https://www.veed.io/view/9613f65a-d015-4504-a7a8-07a7bd65d4e3?panel=share" width="800" height="600" frameborder="0"></iframe></center><center><iframe src="https://www.veed.io/view/1c5e7b7f-2bbb-40c7-aff7-5f915bc05bf0?panel=share" width="800" height="600" frameborder="0"></iframe></center><br><p><a href="https://tekbot-robotics-challenge.github.io/2025-Team-The_Winners-Docs/docs/media/videos" target="_blank" rel="noopener noreferrer"><strong>See more...</strong></a></p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-and-useful-links">Resources and Useful Links<a href="#resources-and-useful-links" class="hash-link" aria-label="Direct link to Resources and Useful Links" title="Direct link to Resources and Useful Links">​</a></h2><p>Provide links to resources, tutorials, and any other useful information that was referenced during the project.</p><ul>
<li><a href="https://www.kicad.org/" target="_blank" rel="noopener noreferrer">KiCad Official Website</a></li>
<li><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf" target="_blank" rel="noopener noreferrer">ATmega328P Datasheet</a></li>
<li><a href="https://invensense.tdk.com/wp-content/uploads/2015/02/MPU-6000-Datasheet1.pdf" target="_blank" rel="noopener noreferrer">MPU 6050 Datasheet</a></li>
<li><a href="https://www.instructables.com/How-to-Make-PCB-Using-Inkjet-Printer/" target="_blank" rel="noopener noreferrer">PCB Fabrication Tutorial</a></li>
<li><a href="https://www.arduino.cc/en/Tutorial/BuiltInExamples/ArduinoToBreadboard" target="_blank" rel="noopener noreferrer">Arduino to ATmega328P Standalone Setup</a></li>
<li><a href="https://www.youtube.com/watch?v=Ycs0t7YHEOE" target="_blank" rel="noopener noreferrer">How to etch PCBs at home (video)</a></li>
</ul></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/preselection/electronic/test2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1rst Test</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/2025-Team-The_Winners-Docs/docs/preselection/electronic/test3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3rd Test</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objectives" class="table-of-contents__link toc-highlight">Objectives</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#files-available-for-download" class="table-of-contents__link toc-highlight">Files available for download</a></li><li><a href="#materials" class="table-of-contents__link toc-highlight">Materials</a><ul><li><a href="#black-box-circuit" class="table-of-contents__link toc-highlight">Black Box Circuit</a></li><li><a href="#signaling-box" class="table-of-contents__link toc-highlight">Signaling box</a></li></ul></li><li><a href="#process" class="table-of-contents__link toc-highlight">Process</a><ul><li><a href="#power-supply-design" class="table-of-contents__link toc-highlight">Power Supply Design</a></li><li><a href="#hardware-design" class="table-of-contents__link toc-highlight">Hardware design</a></li><li><a href="#circuit-design-process" class="table-of-contents__link toc-highlight">Circuit Design Process</a></li><li><a href="#difficulties-and-solving-approach" class="table-of-contents__link toc-highlight">Difficulties and Solving Approach</a></li><li><a href="#software-design" class="table-of-contents__link toc-highlight">Software design</a></li></ul></li><li><a href="#pictures" class="table-of-contents__link toc-highlight">Pictures</a></li><li><a href="#videos" class="table-of-contents__link toc-highlight">Videos</a></li><li><a href="#resources-and-useful-links" class="table-of-contents__link toc-highlight">Resources and Useful Links</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/2025-Team-The_Winners-Docs/docs/tutorial">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>